

Run a performance test to capture a baseline measurement for your Kafka producer, 
using default configuration parameters. This test will send 10000 records of size 8000 bytes each.

```bash
kafka-producer-perf-test \
--topic topic1 \
--num-records 10000 \
--record-size 8000 \
--throughput -1 \
--producer-props bootstrap.servers=localhost:9092
```

The key result to note is in the last line: the throughput being xxx.xxxx records/sec (x.xx MB/sec). 
This is the baseline producer performance with default values.



Run a producer performance test with optimized throughput

```bash
kafka-producer-perf-test \
--topic topic-perf \
--num-records 10000 \
--record-size 8000 \
--throughput -1 \
--producer-props \
    bootstrap.servers=localhost:9092 \
    batch.size=200000 \
    linger.ms=100 \
    compression.type=lz4 \
    acks=1
```




----------------------------------------------------------------------
Test the Producer Performance
----------------------------------------------------------------------
create topic

```bash
kafka-topics \
--create \
--topic topic3 \
--partitions 16 \
--replication-factor 3 \
--config retention.ms=86400000 \
--config min.insync.replicas=2 \
--bootstrap-server localhost:9092 
```

Then run the producer performance test script with different configuration settings. 
The following example will use the topic created above to store 3 million messages with a size of 1 KiB each. 
The -1 value for --throughput means that messages are produced as quickly as possible, with no throttling limit. 
Kafka producer related configuration properties like acks and bootstrap.servers are mentioned as part of --producer-props argument

```bash
kafka-producer-perf-test \
--topic topic3 \
--num-records 3000000 \
--record-size 1024 \
--throughput -1 \
--producer-props \
    acks=all \
    batch.size=200000 \
    linger.ms=100 \
    compression.type=lz4 \
    bootstrap.servers=localhost:9092 
```


In this example, roughly 92k messages are produced per second on average, with a maximum latency of approx. 188 milli-seconds.
The 95th percentile latency of 5 ms means that for 95% of messages (2.85 mill. out of 3 mill.) it took less than two seconds between when they were produced and when they were written on all broker’s filesystem.
In the same way, the 3707 ms value for the 99.9th percentile means that 1 in 1000 messages experienced a delay of ~3.7 seconds from when it was produced until it was published and committed on broker’s segments.

The above command example will create randomly generated byte records with the specified size. Another option for producing test data is to randomly read it from a file, by specifying the --payload-delimiter and --payload-file arguments



----------------------------------------------------------------------
Test the Consumer Performance
----------------------------------------------------------------------


```bash
kafka-consumer-perf-test \
--topic topic3 \
--bootstrap-server localhost:9092 \
--messages 3000000 
```

The above command will consume 3 million messages from the topic perf-test and print the throughput and latency statistics.

The consumer performance test script can also be used to test the performance of a consumer group.
In this case, the --group argument is used to specify the consumer group name, and the --num-fetch-threads argument is used to specify the number of threads used to fetch data.

```bash
kafka-consumer-perf-test \
--topic perf-test \
--bootstrap-server localhost:9092 \
--messages 3000000 \
--group perf-test-group \
--num-fetch-threads 2
```


----------------------------------------------------------------------




